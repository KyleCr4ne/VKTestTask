# VK Test Task
*Тестовое задания для ВКонтакте на позицию инженера машинного обучения*

## Задача

- Подготовить и проверить датасет
- Выбрать модель и обучить ее ранжировать документы по их признакам внутри поисковой сессии
- Посчитать метрику NDCG@5

## Датасет

Файл intern_task.csv

Датасет содержит записи со следующими параметрами:

- **query_id** - идентификатор поисковой сессии
- **feature_i** ($i \in [0, 143]$) - вектор фичей документа
- **rank** - ранг документа (Целочисленные значения от 0 до 4)

## Анализ датасета, предобработка данных

Проанализируем данные датасета, разделим данные на тренировочные и тестовые с учетом особенностей структуры 

[Ноутбук](./DataPreprocessingAndFeatureExtraction.ipynb)

## Модель мультиклассовой классификации

Попробуем посмотреть на данную задачу ранжирования с точки зрения мультиклассовой классификации. Так как за ранжирование документов отвечает rank, принимающий 5 значений, то попробуем спрогнозировать его значение по вектору признаков. Следовательно, в данном предположении мы не учитываем структуру датасета, а именно группировку документов по поисковой сессии. 

[Ноутбук](./MultiClassApproach.ipynb)

Данный подход позволил получить неплохие результаты по метрике NDCG@5.

## Новый подход к созданию модели

В новом подходе попробуем использовать факт того, что ранги имеют упорядоченную структуру.

Теперь будем использовать бинарный классификатор, который определяет *ранг объекта из множества [3, 4] или же из множества [0, 1, 2]*. Таким образом, мы сможем определить вероятность объекта принадлежать одной из двух групп. 

Более подробна идея разобрана в [ноутбуке](./ClassificationNewApproach.ipynb)

## Выводы

Наш новый подход к классификации меток ранга (и дальнейшему ранжированию по ним) действительно показал улучшение качества на тестовой выборке по метрике NDCG. Но стоит учесть, что оба подхода вполне приемлемо справляются с поставленной задачей, и улучшение по метрике не получилось существенным. Связано это с тем, что базовый классификатор, отделяющей объекты на две подгруппы, не так хорощо справляется с предложенными данными. Предобработка данных с выделением несущественных или коррелирующих признаков, стандартизация и прочее, не позволили хорошо обучить используемую логистическую регрессию. Для того, чтобы лучше подготовить данные, так или иначе необходимо понимать некоторое устройство признаков (то есть, знать, что они означают). 




